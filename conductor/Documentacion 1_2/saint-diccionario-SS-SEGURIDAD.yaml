database:
  metadata:
    name: Saint Administrativo - Módulo Seguridad
    version: 2.1.0-MODULAR
    description: Diccionario completo del módulo SS (Seguridad) - 9 tablas documentadas
    created_date: "2025-12-29"
    module: SS
    total_tables: 9
    status: "LISTO PARA PRODUCCIÓN"

  data_types:
    varchar:
      description: Texto variable
      example: "varchar(20) para usernames"
    int:
      description: Número entero
      example: "int para contadores"
    smallint:
      description: Entero pequeño (booleanos)
      example: "0=No, 1=Sí"
    datetime2:
      description: Fecha y hora
      example: "2025-12-29 15:35:00"

  tablas_modulo_ss:
    note: "9 TABLAS DEL MÓDULO SEGURIDAD Y SISTEMA"
    lista_tablas:
      - SSUSRS       # USUARIOS
      - ssautr       # AUTORIZACIÓN USUARIO
      - ssdtaa       # DATOS ADICIONALES
      - ssflds       # FIELDS SEGURIDAD
      - ssfmts       # FORMATOS SEGURIDAD
      - ssnivl       # NIVELES ACCESO
      - ssopmn       # OPERACIONES MENÚ
      - sspard       # PARÁMETROS
      - ssparm       # PARÁMETROS MAESTRO

  tables:
    SSUSRS:
      description: "USUARIOS - Maestro de usuarios del sistema"
      category: Seguridad
      module: SS
      primary_key: CodUsua
      indexes:
        - idx_ssusrs_codusua
        - idx_ssusrs_usuario
      fields:
        CodUsua:
          description: Código del usuario
          type: varchar(20)
          constraints: [PRIMARY KEY, NOT NULL, UNIQUE]
        Usuario:
          description: Nombre de usuario/login
          type: varchar(50)
          constraints: [NOT NULL, UNIQUE]
        Password:
          description: Contraseña (encriptada)
          type: varchar(255)
          constraints: [NOT NULL]
        Nombre:
          description: Nombre completo del usuario
          type: varchar(100)
        Email:
          description: Correo electrónico
          type: varchar(100)
        Estado:
          description: Estado del usuario (Activo/Inactivo)
          type: smallint
          validation: "0=Inactivo, 1=Activo"
        FechaCreacion:
          description: Fecha de creación
          type: datetime2
        UltimoAcceso:
          description: Último acceso al sistema
          type: datetime2
      relationships:
        - "SSUSRS → ssautr [Autorizaciones]"
        - "SSUSRS → ssopmn [Menú de operaciones]"

    ssautr:
      description: "AUTORIZACIÓN USUARIO - Permisos y roles del usuario"
      category: Seguridad
      module: SS
      primary_key: "CodUsua + CodOper"
      fields:
        CodUsua:
          description: Código del usuario
          type: varchar(20)
          constraints: [NOT NULL, FOREIGN KEY]
          foreign_key: SSUSRS.CodUsua
        CodOper:
          description: Código de operación/permiso
          type: varchar(20)
          constraints: [NOT NULL]
        Permitido:
          description: Permiso autorizado
          type: smallint
          validation: "0=No, 1=Sí"
        FechaOtorgado:
          description: Fecha de otorgamiento
          type: datetime2
      relationships:
        - "ssautr.CodUsua → SSUSRS.CodUsua (N:1)"

    ssnivl:
      description: "NIVELES ACCESO - Niveles de acceso del sistema"
      category: Seguridad
      module: SS
      primary_key: CodNivel
      fields:
        CodNivel:
          description: Código del nivel
          type: varchar(10)
          constraints: [PRIMARY KEY, NOT NULL]
        Descripcion:
          description: Descripción del nivel
          type: varchar(100)
        Jerarquia:
          description: Nivel jerárquico (1=Mayor)
          type: int

    ssflds:
      description: "FIELDS SEGURIDAD - Campos de seguridad del sistema"
      category: Seguridad
      module: SS
      fields:
        CodFld:
          description: Código del field
          type: varchar(20)
        Nombre:
          description: Nombre del field
          type: varchar(100)
        Tabla:
          description: Tabla asociada
          type: varchar(20)

    ssfmts:
      description: "FORMATOS SEGURIDAD - Formatos de seguridad"
      category: Seguridad
      module: SS
      fields:
        CodFmto:
          description: Código del formato
          type: varchar(10)
        Nombre:
          description: Nombre del formato
          type: varchar(100)

    ssopmn:
      description: "OPERACIONES MENÚ - Operaciones del menú del usuario"
      category: Seguridad
      module: SS
      primary_key: "CodUsua + CodOper"
      fields:
        CodUsua:
          description: Código del usuario
          type: varchar(20)
          constraints: [FOREIGN KEY]
          foreign_key: SSUSRS.CodUsua
        CodOper:
          description: Código de operación
          type: varchar(20)
        Visible:
          description: Operación visible en menú
          type: smallint

    sspard:
      description: "PARÁMETROS - Parámetros del sistema"
      category: Configuración
      module: SS
      primary_key: CodParam
      fields:
        CodParam:
          description: Código del parámetro
          type: varchar(30)
          constraints: [PRIMARY KEY, NOT NULL]
        Valor:
          description: Valor del parámetro
          type: varchar(500)
        Tipo:
          description: Tipo de parámetro
          type: varchar(20)
        Descripcion:
          description: Descripción
          type: varchar(300)

    ssparm:
      description: "PARÁMETROS MAESTRO - Parámetros maestro del sistema"
      category: Configuración
      module: SS
      fields:
        CodParam:
          description: Código del parámetro
          type: varchar(30)
        NomParam:
          description: Nombre del parámetro
          type: varchar(100)
        ValorDef:
          description: Valor por defecto
          type: varchar(500)

    ssdtaa:
      description: "DATOS ADICIONALES - Datos adicionales de usuarios"
      category: Seguridad
      module: SS
      primary_key: "CodUsua + Campo"
      fields:
        CodUsua:
          description: Código del usuario
          type: varchar(20)
          constraints: [FOREIGN KEY]
          foreign_key: SSUSRS.CodUsua
        Campo:
          description: Nombre del campo adicional
          type: varchar(50)
        Valor:
          description: Valor del campo
          type: varchar(500)

  relationships:
    security_flow:
      usuario_permisos:
        description: "Flujo de autenticación y autorización"
        tablas:
          - "SSUSRS.CodUsua → ssautr.CodUsua (1:N)"
          - "SSUSRS.CodUsua → ssopmn.CodUsua (1:N)"
          - "SSUSRS.CodUsua → ssdtaa.CodUsua (1:N)"

  validations:
    security_rules:
      - "Usuario debe ser único y no vacío"
      - "Contraseña debe estar encriptada"
      - "Usuario activo es requerido para acceso"
      - "Permisos deben estar en ssautr"
      - "Cambios de permiso requieren auditoría"

  statistics:
    total_tables: 9
    fields: 80+
    critical_tables:
      - SSUSRS (maestro de usuarios)
      - ssautr (autorización)
      - sspard (parámetros)

  notes:
    important:
      - "SSUSRS es tabla crítica para autenticación"
      - "ssautr controla todos los permisos"
      - "sspard/ssparm almacenan configuración global"
      - "Cambios en estos módulos requieren reinicio"

    implementation:
      - "1. Crear SSUSRS"
      - "2. Crear sspard/ssparm"
      - "3. Crear ssnivl"
      - "4. Crear ssautr"
      - "5. Crear ssopmn"
