<!-- Divider / Step Indicator -->
<div class="flex items-center gap-4 py-6">
    <div class="h-px flex-1 bg-[#ece7f3] dark:bg-[#382e48]"></div>
    <span class="text-xs font-semibold text-[#6b4c9a] dark:text-[#a589cc] uppercase tracking-wider">Vista Previa de Resultados</span>
    <div class="h-px flex-1 bg-[#ece7f3] dark:bg-[#382e48]"></div>
</div>

<!-- Analysis Results Dashboard -->
<section class="flex flex-col gap-6 animate-in fade-in slide-in-from-bottom-4 duration-700 fill-mode-backwards">
    <!-- Summary Stats -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="bg-white dark:bg-surface-dark p-4 rounded-xl shadow-sm border border-[#d9cfe7] dark:border-[#382e48] flex flex-col justify-between">
            <span class="text-sm font-medium text-[#6b4c9a] dark:text-[#a589cc] mb-1">Total Registros</span>
            <div class="flex items-end gap-2">
                <span class="text-3xl font-bold text-[#130d1b] dark:text-white">{{ stats.total }}</span>
                <span class="text-xs text-[#6b4c9a] dark:text-[#a589cc] mb-1">transacciones</span>
            </div>
        </div>
        <div class="bg-white dark:bg-surface-dark p-4 rounded-xl shadow-sm border border-[#d9cfe7] dark:border-[#382e48] flex flex-col justify-between">
            <span class="text-sm font-medium text-[#6b4c9a] dark:text-[#a589cc] mb-1">Archivo</span>
            <div class="flex items-end gap-2">
                <span class="text-xl font-bold text-[#130d1b] dark:text-white">{{ stats.filename }}</span>
            </div>
        </div>
        <!-- Add more stats as needed, e.g., conciliados, pendientes -->
    </div>

    <!-- Transaction List -->
    <div class="bg-white dark:bg-surface-dark p-6 rounded-xl shadow-sm border border-[#d9cfe7] dark:border-[#382e48]">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-[#130d1b] dark:text-white">Transacciones Detectadas</h3>
            <div class="flex gap-2">
                <button class="flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-[#6b4c9a] dark:text-[#a589cc] bg-white dark:bg-surface-dark border border-[#ece7f3] dark:border-[#382e48] rounded-md hover:bg-background-light dark:hover:bg-[#382e48]">
                    <span class="material-symbols-outlined text-[18px]">filter_list</span>
                    Filtros
                </button>
            </div>
        </div>
        
        <div class="overflow-x-auto">
            <table class="w-full text-left text-sm whitespace-nowrap">
                <thead class="bg-background-light dark:bg-[#1f162e] text-[#6b4c9a] dark:text-[#a589cc] font-semibold uppercase tracking-wider text-xs">
                    <tr>
                        <th class="px-6 py-3 w-[20%] border-r border-[#ece7f3] dark:border-[#382e48]">Fecha</th>
                        <th class="px-6 py-3 w-[30%] border-r border-[#ece7f3] dark:border-[#382e48]">Descripci√≥n</th>
                        <th class="px-6 py-3 w-[20%] border-r border-[#ece7f3] dark:border-[#382e48]">Referencia</th>
                        <th class="px-6 py-3 w-[15%] border-r border-[#ece7f3] dark:border-[#382e48]">Monto</th>
                        <th class="px-6 py-3 w-[15%]">Tipo</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-[#ece7f3] dark:divide-[#382e48]">
                    {% for txn in transacciones %}
                    <tr class="hover:bg-background-light dark:hover:bg-[#1f162e]">
                        <td class="px-6 py-4">{{ txn.raw_date }}</td>
                        <td class="px-6 py-4">{{ txn.description }}</td>
                        <td class="px-6 py-4">{{ txn.reference }}</td>
                        <td class="px-6 py-4">{{ txn.amount }} {{ txn.currency }}</td>
                        <td class="px-6 py-4">{{ txn.transaction_type }}</td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="5" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">No se detectaron transacciones en el archivo.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</section>

<!-- Error Toast (if any) -->
<div hx-swap-oob="afterbegin:#modal-container">
    {% if error_message %}
    <div class="fixed bottom-5 right-5 bg-red-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center"
         x-data="{ show: true }" x-show="show" x-init="setTimeout(() => show = false, 5000)">
        <span class="material-symbols-outlined mr-2">error</span>
        {{ error_message }}
    </div>
    {% endif %}
</div>